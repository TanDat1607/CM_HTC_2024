<?xml version="1.0" encoding="utf-8"?>
<project xmlns="http://www.plcopen.org/xml/tc6_0200">
  <fileHeader companyName="Beckhoff Automation GmbH" productName="TwinCAT PLC Control" productVersion="3.5.13.21" creationDateTime="2024-07-22T16:12:49.8021823" />
  <contentHeader name="CM" modificationDateTime="2024-07-22T16:12:49.8062692">
    <coordinateInfo>
      <fbd>
        <scaling x="1" y="1" />
      </fbd>
      <ld>
        <scaling x="1" y="1" />
      </ld>
      <sfc>
        <scaling x="1" y="1" />
      </sfc>
    </coordinateInfo>
    <addData>
      <data name="http://www.3s-software.com/plcopenxml/projectinformation" handleUnknown="implementation">
        <ProjectInformation />
      </data>
    </addData>
  </contentHeader>
  <types>
    <dataTypes />
    <pous />
  </types>
  <instances>
    <configurations />
  </instances>
  <addData>
    <data name="http://www.3s-software.com/plcopenxml/application" handleUnknown="implementation">
      <resource name="CM">
        <task name="PlcTask" interval="PT0S" priority="4">
          <pouInstance name="MAIN" typeName="">
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml" />
            </documentation>
          </pouInstance>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/tasksettings" handleUnknown="implementation">
              <TaskSettings KindOfTask="Cyclic" Interval="1000" IntervalUnit="us">
                <Watchdog Enabled="false" TimeUnit="ms" />
              </TaskSettings>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>cdcdb954-4ebb-4ef3-bb5b-af9257ff7c35</ObjectId>
            </data>
          </addData>
        </task>
        <task name="PlcTaskCM" interval="PT0S" priority="10">
          <pouInstance name="MAIN_CM" typeName="">
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml" />
            </documentation>
          </pouInstance>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/tasksettings" handleUnknown="implementation">
              <TaskSettings KindOfTask="Cyclic" Interval="5000" IntervalUnit="us">
                <Watchdog Enabled="false" TimeUnit="ms" />
              </TaskSettings>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>e1e11ed9-f333-4b54-9253-b27635168571</ObjectId>
            </data>
          </addData>
        </task>
        <task name="TaskCalc" interval="PT0S" priority="8">
          <pouInstance name="PRG_Calculate" typeName="">
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml" />
            </documentation>
          </pouInstance>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/tasksettings" handleUnknown="implementation">
              <TaskSettings KindOfTask="Cyclic" Interval="1000" IntervalUnit="us">
                <Watchdog Enabled="false" TimeUnit="ms" />
              </TaskSettings>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>628d2a1e-b407-4f45-b435-117ba41b8a1f</ObjectId>
            </data>
          </addData>
        </task>
        <globalVars name="CM_Params" constant="true">
          <variable name="cOversamples">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="10" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> number of oversamples</xhtml>
            </documentation>
          </variable>
          <variable name="cMaxChannels">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="2" />
            </initialValue>
          </variable>
          <variable name="cOrder">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="1" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> Maximum order of integration: 0 = acceleration, 1 = velocity, 2 = place. </xhtml>
            </documentation>
          </variable>
          <variable name="cBufferLength">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="1600" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> buffer size</xhtml>
            </documentation>
          </variable>
          <variable name="cWindowLength">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="3200" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> internal buffer size with 50% overlapping</xhtml>
            </documentation>
          </variable>
          <variable name="cRMSBuffer">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="4800" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> e.g. keep 2 old buffers in mind and add one new buffer to calc RMS value	</xhtml>
            </documentation>
          </variable>
          <variable name="cFFTResult">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="2049" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> result of mag. spectrum (cFFTLength/2+1)</xhtml>
            </documentation>
          </variable>
          <variable name="cFFTLength">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="4096" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> length of FFT for mag. spectrum	</xhtml>
            </documentation>
          </variable>
          <variable name="cScaleHMI">
            <type>
              <UDINT />
            </type>
            <initialValue>
              <simpleValue value="50" />
            </initialValue>
          </variable>
          <variable name="cWindowParameters">
            <type>
              <derived name="T_CM_WindowParameters" />
            </type>
            <initialValue>
              <arrayValue>
                <value>
                  <simpleValue value="0.0" />
                </value>
                <value>
                  <simpleValue value="0.0" />
                </value>
                <value>
                  <simpleValue value="0.0" />
                </value>
                <value>
                  <simpleValue value="0.0" />
                </value>
                <value>
                  <simpleValue value="0.0" />
                </value>
              </arrayValue>
            </initialValue>
          </variable>
          <variable name="cInitSource">
            <type>
              <derived name="ST_MA_MultiArray_InitPars" />
            </type>
            <initialValue>
              <structValue>
                <value member="eTypeCode">
                  <simpleValue value="eMA_TypeCode_LREAL" />
                </value>
                <value member="nDims">
                  <simpleValue value="2" />
                </value>
                <value member="aDimSizes">
                  <arrayValue>
                    <value>
                      <simpleValue value="cMaxChannels" />
                    </value>
                    <value>
                      <simpleValue value="cBufferLength" />
                    </value>
                  </arrayValue>
                </value>
              </structValue>
            </initialValue>
          </variable>
          <variable name="cInitSpectrum">
            <type>
              <derived name="ST_CM_MagnitudeSpectrum_InitPars" />
            </type>
            <initialValue>
              <structValue>
                <value member="nFFT_Length">
                  <simpleValue value="cFFTLength" />
                </value>
                <value member="nWindowLength">
                  <simpleValue value="cWindowLength" />
                </value>
                <value member="nChannels">
                  <simpleValue value="cMaxChannels" />
                </value>
                <value member="bTransformToDecibel">
                  <simpleValue value="FALSE" />
                </value>
                <value member="eWindowType">
                  <simpleValue value="E_CM_WindowType.eCM_HannWindow" />
                </value>
                <value member="nOverlap">
                  <simpleValue value="(cWindowLength / 2)" />
                </value>
                <value member="eScalingType">
                  <simpleValue value="E_CM_ScalingType.eCM_RMS" />
                </value>
              </structValue>
            </initialValue>
          </variable>
          <variable name="cInitEnvSpec">
            <type>
              <derived name="ST_CM_EnvelopeSpectrum_InitPars" />
            </type>
            <initialValue>
              <structValue>
                <value member="nFFT_Length">
                  <simpleValue value="cFFTLength" />
                </value>
                <value member="nWindowLength">
                  <simpleValue value="cWindowLength" />
                </value>
                <value member="nChannels">
                  <simpleValue value="cMaxChannels" />
                </value>
                <value member="bTransformToDecibel">
                  <simpleValue value="FALSE" />
                </value>
                <value member="fDecibelThreshold">
                  <simpleValue value="cCM_MinArgLog10" />
                </value>
                <value member="eWindowType">
                  <simpleValue value="eCM_HannWindow" />
                </value>
                <value member="nOverlap">
                  <simpleValue value="(cWindowLength / 2)" />
                </value>
                <value member="eScalingType">
                  <simpleValue value="eCM_RMS" />
                </value>
              </structValue>
            </initialValue>
          </variable>
          <variable name="cInitEnv">
            <type>
              <derived name="ST_CM_Envelope_InitPars" />
            </type>
            <initialValue>
              <structValue>
                <value member="nFFT_Length">
                  <simpleValue value="cFFTLength" />
                </value>
                <value member="nWindowLength">
                  <simpleValue value="cWindowLength" />
                </value>
                <value member="nChannels">
                  <simpleValue value="cMaxChannels" />
                </value>
              </structValue>
            </initialValue>
          </variable>
          <variable name="cInitIRMS">
            <type>
              <derived name="ST_CM_IntegratedRMS_InitPars" />
            </type>
            <initialValue>
              <structValue>
                <value member="nFFT_Length">
                  <simpleValue value="cFFTLength" />
                </value>
                <value member="nWindowLength">
                  <simpleValue value="cWindowLength" />
                </value>
                <value member="fSampleRate">
                  <simpleValue value="10000" />
                </value>
                <value member="fLowerFrequencyLimit">
                  <simpleValue value="20.0" />
                </value>
                <value member="fUpperFrequencyLimit">
                  <simpleValue value="4000.0" />
                </value>
                <value member="nMaxBands">
                  <simpleValue value="1" />
                </value>
                <value member="nOrder">
                  <simpleValue value="cOrder" />
                </value>
                <value member="nChannels">
                  <simpleValue value="cMaxChannels" />
                </value>
                <value member="eWindowType">
                  <simpleValue value="E_CM_WindowType.eCM_HannWindow" />
                </value>
                <value member="nOverlap">
                  <simpleValue value="(cWindowLength / 2)" />
                </value>
                <value member="bTransformToDecibel">
                  <simpleValue value="FALSE" />
                </value>
              </structValue>
            </initialValue>
          </variable>
          <variable name="fSampleTaskCycleTime">
            <type>
              <LREAL />
            </type>
            <initialValue>
              <simpleValue value="1" />
            </initialValue>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> ms</xhtml>
            </documentation>
          </variable>
          <variable name="fSampleRate">
            <type>
              <LREAL />
            </type>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> Hz  ( sample rate = oversampling factor / cycle time )</xhtml>
            </documentation>
          </variable>
          <variable name="fResolution">
            <type>
              <LREAL />
            </type>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> Hz/Idx	</xhtml>
            </documentation>
          </variable>
          <variable name="aAccAlarm">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aVeloAlarm">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aEnvAlarm">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aAccWarning">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aVeloWarning">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aEnvWarning">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="nCurrentDate">
            <type>
              <WORD />
            </type>
          </variable>
          <variable name="sCurrentTime">
            <type>
              <string />
            </type>
          </variable>
          <variable name="nCurrentHour">
            <type>
              <WORD />
            </type>
          </variable>
          <variable name="nCurrentSec">
            <type>
              <WORD />
            </type>
          </variable>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
              <InterfaceAsPlainText>
                <xhtml xmlns="http://www.w3.org/1999/xhtml">  VAR_GLOBAL CONSTANT
	cOversamples 		: UDINT 	:= 10;		// number of oversamples
	cMaxChannels		: UDINT		:= 2;
	cOrder				: UDINT		:= 1;		// Maximum order of integration: 0 = acceleration, 1 = velocity, 2 = place. 
	cBufferLength		: UDINT		:= 1600;	// buffer size
	cWindowLength		: UDINT		:= 3200;	// internal buffer size with 50% overlapping
	cRMSBuffer     		: UDINT 	:= 4800;  	// e.g. keep 2 old buffers in mind and add one new buffer to calc RMS value	
	cFFTResult 			: UDINT 	:= 2049;	// result of mag. spectrum (cFFTLength/2+1)
	cFFTLength			: UDINT		:= 4096;	// length of FFT for mag. spectrum	
	cScaleHMI			: UDINT     := 50;
	cWindowParameters	: T_CM_WindowParameters := [0.0, 0.0, 0.0, 0.0, 0.0];	
	
    cInitSource			: ST_MA_MultiArray_InitPars 
						:= ( 	eTypeCode 			:= eMA_TypeCode_LREAL, 
								nDims 				:= 2, 
								aDimSizes 			:= [cMaxChannels,cBufferLength]);	
	
	cInitSpectrum 		: ST_CM_MagnitudeSpectrum_InitPars 
						:= (	nFFT_Length 		:= cFFTLength, 
								nWindowLength 		:= cWindowLength,
								nChannels			:= cMaxChannels,
								bTransformToDecibel	:= FALSE, 
								eWindowType 		:= E_CM_WindowType.eCM_HannWindow, 
								nOverlap			:= cWindowLength/2,
								eScalingType 		:= E_CM_ScalingType.eCM_RMS);
								
	cInitEnvSpec 		: ST_CM_EnvelopeSpectrum_InitPars 
						:= (	nFFT_Length			:= cFFTLength,
								nWindowLength		:= cWindowLength,
								nChannels			:= cMaxChannels,
								bTransformToDecibel	:= FALSE,
								fDecibelThreshold	:= cCM_MinArgLog10, 
								eWindowType			:= eCM_HannWindow,  
								nOverlap			:= cWindowLength/2,         
								eScalingType 		:= eCM_RMS);   
								
	cInitEnv	 		: ST_CM_Envelope_InitPars 
						:= (	nFFT_Length			:= cFFTLength,
								nWindowLength		:= cWindowLength,
								nChannels			:= cMaxChannels);   	
		
	cInitIRMS			: ST_CM_IntegratedRMS_InitPars
						:= ( 	nFFT_Length			:= cFFTLength,
								nWindowLength		:= cWindowLength,
								fSampleRate			:= 10000,
								fLowerFrequencyLimit	:= 20.0,
								fUpperFrequencyLimit	:= 4000.0,
								nMaxBands			:= 1,
								nOrder				:= cOrder,
								nChannels			:= cMaxChannels,
								eWindowType			:= E_CM_WindowType.eCM_HannWindow,
								nOverlap			:=  cWindowLength/2,
								bTransformToDecibel	:= FALSE);
					
END_VAR

VAR_GLOBAL
	fSampleTaskCycleTime		: LREAL := 1; 	// ms
	fSampleRate					: LREAL; 		// Hz  ( sample rate = oversampling factor / cycle time )
	fResolution					: LREAL; 		// Hz/Idx	
	aAccAlarm					: ARRAY[1..cMaxChannels] OF LREAL;
	aVeloAlarm					: ARRAY[1..cMaxChannels] OF LREAL;
	aEnvAlarm					: ARRAY[1..cMaxChannels] OF LREAL;
	
	aAccWarning					: ARRAY[1..cMaxChannels] OF LREAL;
	aVeloWarning				: ARRAY[1..cMaxChannels] OF LREAL;
	aEnvWarning					: ARRAY[1..cMaxChannels] OF LREAL;
	
	nCurrentDate				: WORD;
	sCurrentTime				: STRING;
	nCurrentHour				: WORD;
	nCurrentSec					: WORD;
	
END_VAR
</xhtml>
              </InterfaceAsPlainText>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>b7ffc7d5-c01a-4239-986a-7d3c590e2c97</ObjectId>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/mixedattrsvarlist" handleUnknown="implementation">
              <MixedAttrsVarList>
                <globalVars name="CM_Params" constant="true">
                  <variable name="cOversamples">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="10" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> number of oversamples</xhtml>
                    </documentation>
                  </variable>
                  <variable name="cMaxChannels">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="2" />
                    </initialValue>
                  </variable>
                  <variable name="cOrder">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> Maximum order of integration: 0 = acceleration, 1 = velocity, 2 = place. </xhtml>
                    </documentation>
                  </variable>
                  <variable name="cBufferLength">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1600" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> buffer size</xhtml>
                    </documentation>
                  </variable>
                  <variable name="cWindowLength">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="3200" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> internal buffer size with 50% overlapping</xhtml>
                    </documentation>
                  </variable>
                  <variable name="cRMSBuffer">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="4800" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> e.g. keep 2 old buffers in mind and add one new buffer to calc RMS value	</xhtml>
                    </documentation>
                  </variable>
                  <variable name="cFFTResult">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="2049" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> result of mag. spectrum (cFFTLength/2+1)</xhtml>
                    </documentation>
                  </variable>
                  <variable name="cFFTLength">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="4096" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> length of FFT for mag. spectrum	</xhtml>
                    </documentation>
                  </variable>
                  <variable name="cScaleHMI">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="50" />
                    </initialValue>
                  </variable>
                  <variable name="cWindowParameters">
                    <type>
                      <derived name="T_CM_WindowParameters" />
                    </type>
                    <initialValue>
                      <arrayValue>
                        <value>
                          <simpleValue value="0.0" />
                        </value>
                        <value>
                          <simpleValue value="0.0" />
                        </value>
                        <value>
                          <simpleValue value="0.0" />
                        </value>
                        <value>
                          <simpleValue value="0.0" />
                        </value>
                        <value>
                          <simpleValue value="0.0" />
                        </value>
                      </arrayValue>
                    </initialValue>
                  </variable>
                  <variable name="cInitSource">
                    <type>
                      <derived name="ST_MA_MultiArray_InitPars" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="eTypeCode">
                          <simpleValue value="eMA_TypeCode_LREAL" />
                        </value>
                        <value member="nDims">
                          <simpleValue value="2" />
                        </value>
                        <value member="aDimSizes">
                          <arrayValue>
                            <value>
                              <simpleValue value="cMaxChannels" />
                            </value>
                            <value>
                              <simpleValue value="cBufferLength" />
                            </value>
                          </arrayValue>
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="cInitSpectrum">
                    <type>
                      <derived name="ST_CM_MagnitudeSpectrum_InitPars" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nFFT_Length">
                          <simpleValue value="cFFTLength" />
                        </value>
                        <value member="nWindowLength">
                          <simpleValue value="cWindowLength" />
                        </value>
                        <value member="nChannels">
                          <simpleValue value="cMaxChannels" />
                        </value>
                        <value member="bTransformToDecibel">
                          <simpleValue value="FALSE" />
                        </value>
                        <value member="eWindowType">
                          <simpleValue value="E_CM_WindowType.eCM_HannWindow" />
                        </value>
                        <value member="nOverlap">
                          <simpleValue value="(cWindowLength / 2)" />
                        </value>
                        <value member="eScalingType">
                          <simpleValue value="E_CM_ScalingType.eCM_RMS" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="cInitEnvSpec">
                    <type>
                      <derived name="ST_CM_EnvelopeSpectrum_InitPars" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nFFT_Length">
                          <simpleValue value="cFFTLength" />
                        </value>
                        <value member="nWindowLength">
                          <simpleValue value="cWindowLength" />
                        </value>
                        <value member="nChannels">
                          <simpleValue value="cMaxChannels" />
                        </value>
                        <value member="bTransformToDecibel">
                          <simpleValue value="FALSE" />
                        </value>
                        <value member="fDecibelThreshold">
                          <simpleValue value="cCM_MinArgLog10" />
                        </value>
                        <value member="eWindowType">
                          <simpleValue value="eCM_HannWindow" />
                        </value>
                        <value member="nOverlap">
                          <simpleValue value="(cWindowLength / 2)" />
                        </value>
                        <value member="eScalingType">
                          <simpleValue value="eCM_RMS" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="cInitEnv">
                    <type>
                      <derived name="ST_CM_Envelope_InitPars" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nFFT_Length">
                          <simpleValue value="cFFTLength" />
                        </value>
                        <value member="nWindowLength">
                          <simpleValue value="cWindowLength" />
                        </value>
                        <value member="nChannels">
                          <simpleValue value="cMaxChannels" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="cInitIRMS">
                    <type>
                      <derived name="ST_CM_IntegratedRMS_InitPars" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nFFT_Length">
                          <simpleValue value="cFFTLength" />
                        </value>
                        <value member="nWindowLength">
                          <simpleValue value="cWindowLength" />
                        </value>
                        <value member="fSampleRate">
                          <simpleValue value="10000" />
                        </value>
                        <value member="fLowerFrequencyLimit">
                          <simpleValue value="20.0" />
                        </value>
                        <value member="fUpperFrequencyLimit">
                          <simpleValue value="4000.0" />
                        </value>
                        <value member="nMaxBands">
                          <simpleValue value="1" />
                        </value>
                        <value member="nOrder">
                          <simpleValue value="cOrder" />
                        </value>
                        <value member="nChannels">
                          <simpleValue value="cMaxChannels" />
                        </value>
                        <value member="eWindowType">
                          <simpleValue value="E_CM_WindowType.eCM_HannWindow" />
                        </value>
                        <value member="nOverlap">
                          <simpleValue value="(cWindowLength / 2)" />
                        </value>
                        <value member="bTransformToDecibel">
                          <simpleValue value="FALSE" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                </globalVars>
                <globalVars name="CM_Params">
                  <variable name="fSampleTaskCycleTime">
                    <type>
                      <LREAL />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> ms</xhtml>
                    </documentation>
                  </variable>
                  <variable name="fSampleRate">
                    <type>
                      <LREAL />
                    </type>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> Hz  ( sample rate = oversampling factor / cycle time )</xhtml>
                    </documentation>
                  </variable>
                  <variable name="fResolution">
                    <type>
                      <LREAL />
                    </type>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> Hz/Idx	</xhtml>
                    </documentation>
                  </variable>
                  <variable name="aAccAlarm">
                    <type>
                      <array>
                        <dimension lower="1" upper="cMaxChannels" />
                        <baseType>
                          <LREAL />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="aVeloAlarm">
                    <type>
                      <array>
                        <dimension lower="1" upper="cMaxChannels" />
                        <baseType>
                          <LREAL />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="aEnvAlarm">
                    <type>
                      <array>
                        <dimension lower="1" upper="cMaxChannels" />
                        <baseType>
                          <LREAL />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="aAccWarning">
                    <type>
                      <array>
                        <dimension lower="1" upper="cMaxChannels" />
                        <baseType>
                          <LREAL />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="aVeloWarning">
                    <type>
                      <array>
                        <dimension lower="1" upper="cMaxChannels" />
                        <baseType>
                          <LREAL />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="aEnvWarning">
                    <type>
                      <array>
                        <dimension lower="1" upper="cMaxChannels" />
                        <baseType>
                          <LREAL />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="nCurrentDate">
                    <type>
                      <WORD />
                    </type>
                  </variable>
                  <variable name="sCurrentTime">
                    <type>
                      <string />
                    </type>
                  </variable>
                  <variable name="nCurrentHour">
                    <type>
                      <WORD />
                    </type>
                  </variable>
                  <variable name="nCurrentSec">
                    <type>
                      <WORD />
                    </type>
                  </variable>
                </globalVars>
              </MixedAttrsVarList>
            </data>
          </addData>
        </globalVars>
        <globalVars name="CM_Data">
          <variable name="aAccBuffer">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cOversamples" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aMagSpecResult">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cFFTResult" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aVeloSpecResult">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cFFTResult" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aEnvSpecResult">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cFFTResult" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aEnvResult">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cBufferLength" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aRMSResult">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="(cOrder + 1)" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aRMSEnvResult">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="fFrequency">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cFFTResult" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> Hz	</xhtml>
            </documentation>
          </variable>
          <variable name="aTWFBuffer">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="(cOversamples * cScaleHMI)" />
                    <baseType>
                      <LREAL />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aTime">
            <type>
              <array>
                <dimension lower="1" upper="(cOversamples * cScaleHMI)" />
                <baseType>
                  <UDINT />
                </baseType>
              </array>
            </type>
          </variable>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/buildproperties" handleUnknown="implementation">
              <BuildProperties>
                <LinkAlways>true</LinkAlways>
              </BuildProperties>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
              <InterfaceAsPlainText>
                <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR_GLOBAL

	aAccBuffer			: ARRAY[1..cMaxChannels] OF ARRAY[1..cOversamples] OF LREAL;   	
		
	aMagSpecResult		: ARRAY[1..cMaxChannels] OF ARRAY[1..cFFTResult] OF LREAL;	
	aVeloSpecResult		: ARRAY[1..cMaxChannels] OF ARRAY[1..cFFTResult] OF LREAL;
	aEnvSpecResult		: ARRAY[1..cMaxChannels] OF ARRAY[1..cFFTResult] OF LREAL;
	
	aEnvResult			: ARRAY[1..cMaxChannels] OF ARRAY[1..cBufferLength] OF LREAL;
		
	aRMSResult			: ARRAY[1..cMaxChannels] OF ARRAY[1..cOrder+1] OF LREAL;
	aRMSEnvResult		: ARRAY[1..cMaxChannels] OF LREAL;

	fFrequency			: ARRAY[1..cMaxChannels] OF ARRAY[1..cFFTResult] OF LREAL; 		// Hz	
	aTWFBuffer			: ARRAY[1..cMaxChannels] OF ARRAY[1..cOversamples*cScaleHMI] OF LREAL;  
	aTime				: ARRAY[1..cOversamples*cScaleHMI] OF UDINT;	
END_VAR</xhtml>
              </InterfaceAsPlainText>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>af15e22b-5a15-4213-aaa6-6abac18438b4</ObjectId>
            </data>
          </addData>
        </globalVars>
        <globalVars name="GVL_ADS">
          <variable name="aFFTAcceleration1Add">
            <type>
              <array>
                <dimension lower="1" upper="cFFTResult" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aFFTVelocity1Add">
            <type>
              <array>
                <dimension lower="1" upper="cFFTResult" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aFFTEnvelope1Add">
            <type>
              <array>
                <dimension lower="1" upper="cFFTResult" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="RMSAcc1Add">
            <type>
              <LREAL />
            </type>
          </variable>
          <variable name="RMSVel1Add">
            <type>
              <LREAL />
            </type>
          </variable>
          <variable name="RMSEnv1Add">
            <type>
              <LREAL />
            </type>
          </variable>
          <variable name="Temperature1Add">
            <type>
              <REAL />
            </type>
          </variable>
          <variable name="aFFTAcceleration2Add">
            <type>
              <array>
                <dimension lower="1" upper="cFFTResult" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml">point_2</xhtml>
            </documentation>
          </variable>
          <variable name="aFFTVelocity2Add">
            <type>
              <array>
                <dimension lower="1" upper="cFFTResult" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="aFFTEnvelope2Add">
            <type>
              <array>
                <dimension lower="1" upper="cFFTResult" />
                <baseType>
                  <LREAL />
                </baseType>
              </array>
            </type>
          </variable>
          <variable name="RMSAcc2Add">
            <type>
              <LREAL />
            </type>
          </variable>
          <variable name="RMSVel2Add">
            <type>
              <LREAL />
            </type>
          </variable>
          <variable name="RMSEnv2Add">
            <type>
              <LREAL />
            </type>
          </variable>
          <variable name="Temperature2Add">
            <type>
              <REAL />
            </type>
          </variable>
          <variable name="bAddData">
            <type>
              <BOOL />
            </type>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml">bAdd</xhtml>
            </documentation>
          </variable>
          <variable name="bCheckADS">
            <type>
              <BOOL />
            </type>
          </variable>
          <variable name="bError">
            <type>
              <BOOL />
            </type>
          </variable>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
              <InterfaceAsPlainText>
                <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR_GLOBAL
	aFFTAcceleration1Add 	: ARRAY[1..cFFTResult] OF LREAL;
	aFFTVelocity1Add 		: ARRAY[1..cFFTResult] OF LREAL;
	aFFTEnvelope1Add 		: ARRAY[1..cFFTResult] OF LREAL;
	RMSAcc1Add				: LREAL;
	RMSVel1Add				: LREAL;
	RMSEnv1Add				: LREAL;
	Temperature1Add			: REAL;
	//point_2
	aFFTAcceleration2Add 	: ARRAY[1..cFFTResult] OF LREAL;
	aFFTVelocity2Add 		: ARRAY[1..cFFTResult] OF LREAL;
	aFFTEnvelope2Add 		: ARRAY[1..cFFTResult] OF LREAL;
	RMSAcc2Add				: LREAL;
	RMSVel2Add				: LREAL;
	RMSEnv2Add				: LREAL;
	Temperature2Add			: REAL;
	//bAdd
	bAddData				: BOOL;
	bCheckADS				: BOOL;
	bError					: BOOL;
END_VAR</xhtml>
              </InterfaceAsPlainText>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>dd8c9214-c0f8-4f89-aa33-d6e95d86f9cb</ObjectId>
            </data>
          </addData>
        </globalVars>
        <globalVars name="GVL_IO">
          <variable name="aEl3632" address="%I*">
            <type>
              <array>
                <dimension lower="1" upper="cMaxChannels" />
                <baseType>
                  <array>
                    <dimension lower="1" upper="cOversamples" />
                    <baseType>
                      <INT />
                    </baseType>
                  </array>
                </baseType>
              </array>
            </type>
            <documentation>
              <xhtml xmlns="http://www.w3.org/1999/xhtml"> Input from hardware e.g. EL3632	</xhtml>
            </documentation>
          </variable>
          <variable name="wMotorRun" address="%Q*">
            <type>
              <WORD />
            </type>
          </variable>
          <variable name="wFreq" address="%Q*">
            <type>
              <WORD />
            </type>
          </variable>
          <variable name="bRev" address="%I*">
            <type>
              <BOOL />
            </type>
          </variable>
          <variable name="bMotorRun">
            <type>
              <BOOL />
            </type>
          </variable>
          <variable name="fFreq">
            <type>
              <REAL />
            </type>
          </variable>
          <addData>
            <data name="http://www.3s-software.com/plcopenxml/buildproperties" handleUnknown="implementation">
              <BuildProperties>
                <LinkAlways>true</LinkAlways>
              </BuildProperties>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
              <InterfaceAsPlainText>
                <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR_GLOBAL
	aEl3632 AT %I*		: ARRAY[1..cMaxChannels] OF ARRAY[1..cOversamples] OF INT;	// Input from hardware e.g. EL3632	
	wMotorRun	AT %Q*	: WORD;
	wFreq		AT %Q*	: WORD;
	bRev		AT %I*	: BOOL;
	bMotorRun			: BOOL;
	fFreq				: REAL;
END_VAR</xhtml>
              </InterfaceAsPlainText>
            </data>
            <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
              <ObjectId>9a7e8e54-9d5a-417d-b728-f2e366fe1d2a</ObjectId>
            </data>
          </addData>
        </globalVars>
        <addData>
          <data name="http://www.3s-software.com/plcopenxml/datatype" handleUnknown="implementation">
            <dataType name="E_AnalysisIDs">
              <baseType>
                <enum>
                  <values>
                    <value name="eID_Source" value="1" />
                    <value name="eID_MagSpectrum" />
                    <value name="eID_MagSpec_Sink" />
                    <value name="eID_RMS" />
                    <value name="eID_RMS_Sink" />
                    <value name="eID_EnvSpectrum" />
                    <value name="eID_EnvSpec_Sink" />
                    <value name="eID_Env" />
                    <value name="eID_Env_Sink" />
                  </values>
                  <baseType>
                    <UDINT />
                  </baseType>
                </enum>
              </baseType>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/enumvaluedocumentation" handleUnknown="implementation">
                  <EnumValueDocumentation>
                    <EnumValue>
                      <Name>eID_Source</Name>
                      <Documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> analysis chain </xhtml>
                      </Documentation>
                    </EnumValue>
                    <EnumValue>
                      <Name>eID_MagSpectrum</Name>
                      <Documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Magnetude Spectrum</xhtml>
                      </Documentation>
                    </EnumValue>
                    <EnumValue>
                      <Name>eID_RMS</Name>
                      <Documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> RMS intergrate</xhtml>
                      </Documentation>
                    </EnumValue>
                    <EnumValue>
                      <Name>eID_EnvSpectrum</Name>
                      <Documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Envelope Spectrum</xhtml>
                      </Documentation>
                    </EnumValue>
                    <EnumValue>
                      <Name>eID_Env</Name>
                      <Documentation>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml"> Envelope </xhtml>
                      </Documentation>
                    </EnumValue>
                  </EnumValueDocumentation>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">TYPE E_AnalysisIDs :
(
	(* analysis chain *)
	eID_Source := 1,
	
	// Magnetude Spectrum
	eID_MagSpectrum,	
	eID_MagSpec_Sink, 
	
	// RMS intergrate
	eID_RMS,	
	eID_RMS_Sink,
	
	// Envelope Spectrum
	eID_EnvSpectrum,	
	eID_EnvSpec_Sink,
	
	// Envelope 
	eID_Env,	
	eID_Env_Sink	
	
) UDINT;
END_TYPE
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>986ef521-a979-48e2-815b-4873c48699c5</ObjectId>
                </data>
              </addData>
            </dataType>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/datatype" handleUnknown="implementation">
            <dataType name="ST_HRErrHist">
              <baseType>
                <struct>
                  <variable name="hrErrCode">
                    <type>
                      <derived name="HRESULT" />
                    </type>
                    <addData>
                      <data name="http://www.3s-software.com/plcopenxml/attributes" handleUnknown="implementation">
                        <Attributes>
                          <Attribute Name="displaymode" Value="hex" />
                        </Attributes>
                      </data>
                    </addData>
                  </variable>
                  <variable name="sErrSource">
                    <type>
                      <string length="63" />
                    </type>
                  </variable>
                  <variable name="nErrCount">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                </struct>
              </baseType>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">TYPE ST_HRErrHist :
STRUCT
{attribute 'displaymode':='hex'}
	hrErrCode	: HRESULT;
	sErrSource	: STRING(63);
	nErrCount	: UDINT;
END_STRUCT
END_TYPE
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>92d421d1-d14f-450b-983f-70e2be9df404</ObjectId>
                </data>
              </addData>
            </dataType>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="FB_HRErrHist" pouType="functionBlock">
              <interface>
                <inputVars>
                  <variable name="bEdgeDetect">
                    <type>
                      <BOOL />
                    </type>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> FALSE: every input(bErr) is processed; TRUE: only rising edge of input is processed </xhtml>
                    </documentation>
                  </variable>
                </inputVars>
                <outputVars>
                  <variable name="nErrSum">
                    <type>
                      <UINT />
                    </type>
                  </variable>
                  <variable name="nErrIdx">
                    <type>
                      <UINT />
                    </type>
                    <documentation>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml"> error list index of last occured error (max. cHistLen)</xhtml>
                    </documentation>
                  </variable>
                  <variable name="aErrList">
                    <type>
                      <array>
                        <dimension lower="1" upper="cHistLen" />
                        <baseType>
                          <derived name="ST_HRErrHist" />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                </outputVars>
                <localVars>
                  <variable name="bNewErr">
                    <type>
                      <BOOL />
                    </type>
                  </variable>
                  <variable name="fbErrTrig">
                    <type>
                      <derived name="R_TRIG" />
                    </type>
                  </variable>
                </localVars>
                <localVars constant="true">
                  <variable name="cHistLen">
                    <type>
                      <UINT />
                    </type>
                    <initialValue>
                      <simpleValue value="100" />
                    </initialValue>
                  </variable>
                </localVars>
              </interface>
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml" />
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/method" handleUnknown="implementation">
                  <Method name="AddError" ObjectId="3dd500b8-1225-4214-9779-654309748312">
                    <interface>
                      <inputVars>
                        <variable name="bErr">
                          <type>
                            <BOOL />
                          </type>
                        </variable>
                        <variable name="hrErrCode">
                          <type>
                            <derived name="HRESULT" />
                          </type>
                        </variable>
                        <variable name="sErrSource">
                          <type>
                            <string length="63" />
                          </type>
                        </variable>
                      </inputVars>
                    </interface>
                    <body>
                      <ST>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">fbErrTrig(CLK:=bErr);
IF bEdgeDetect THEN
	bNewErr := fbErrTrig.Q;
ELSE
	bNewErr := bErr;
END_IF

IF bNewErr THEN
	nErrSum := nErrSum + 1;
	IF nErrIdx &lt; cHistLen THEN
		IF nErrIdx = 0 THEN
			nErrIdx	:= nErrIdx + 1;
		ELSIF aErrList[nErrIdx].hrErrCode &lt;&gt; hrErrCode OR aErrList[nErrIdx].sErrSource &lt;&gt; sErrSource THEN
			nErrIdx	:= nErrIdx + 1;
		END_IF
		aErrList[nErrIdx].hrErrCode := hrErrCode;
		aErrList[nErrIdx].sErrSource := sErrSource;
		aErrList[nErrIdx].nErrCount := aErrList[nErrIdx].nErrCount + 1;
	END_IF
END_IF
</xhtml>
                      </ST>
                    </body>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">METHOD AddError
VAR_INPUT
	bErr		: BOOL;
	hrErrCode	: HRESULT;
	sErrSource	: STRING(63);
END_VAR
</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Method>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/method" handleUnknown="implementation">
                  <Method name="Reset" ObjectId="ce39411f-0156-4af2-b1ba-49d3b754a640">
                    <interface />
                    <body>
                      <ST>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">nErrSum := 0;
nErrIdx := 0;
MEMSET(ADR(aErrList),0,SIZEOF(aErrList));</xhtml>
                      </ST>
                    </body>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">METHOD Reset
VAR_INPUT
END_VAR
</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Method>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">FUNCTION_BLOCK FB_HRErrHist
(* v1.10
build up an error history consisting of two arrays and one index.
The index shows the actual array position. The last error id and the count for this id are saved in the arrays.
If an error id is the same as the previous input error the counter is increased. Otherwise the index is increased.
*)
VAR_INPUT
	bEdgeDetect	: BOOL;	(* FALSE: every input(bErr) is processed; TRUE: only rising edge of input is processed *)
END_VAR
VAR_OUTPUT
	nErrSum		: UINT;
	nErrIdx		: UINT; // error list index of last occured error (max. cHistLen)
	aErrList	: ARRAY[1..cHistLen] OF ST_HRErrHist;
END_VAR

VAR
	bNewErr		: BOOL;
	fbErrTrig	: R_TRIG;
END_VAR
VAR CONSTANT
	cHistLen	: UINT := 100;
END_VAR</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>13dd99e4-0dfe-493f-a13d-ce2e0387ba70</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="FB_SystemTime" pouType="functionBlock">
              <interface>
                <localVars>
                  <variable name="GetLocalSystemTime">
                    <type>
                      <derived name="FB_LocalSystemTime" />
                    </type>
                  </variable>
                  <variable name="wDateW">
                    <type>
                      <WORD />
                    </type>
                  </variable>
                </localVars>
              </interface>
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml">GetLocalSystemTime(bEnable := TRUE);</xhtml>
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="dtDateTimeFull" ObjectId="5d9db981-e399-476f-9f44-b7969859fd33">
                    <interface>
                      <returnType>
                        <DT />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">dtDateTimeFull 	:= SYSTEMTIME_TO_DT(GetLocalSystemTime.systemTime);</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY dtDateTimeFull : DT</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="sDate" ObjectId="adb2b91a-c3a4-4948-a9ab-17c03886c6a1">
                    <interface>
                      <returnType>
                        <string />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">sDate	:= MID(sDateTimeFull,10,1);</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY sDate : STRING</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="sDateTime" ObjectId="ddd67e66-e1a4-4207-aac8-28653586b9f3">
                    <interface>
                      <returnType>
                        <string />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">sDateTime := MID(sDateTimeFull,19,1);</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY sDateTime : STRING</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="sDateTimeFull" ObjectId="ec972ccc-929a-446b-93da-990283db8464">
                    <interface>
                      <returnType>
                        <string />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">sDateTimeFull 	:= SYSTEMTIME_TO_STRING(GetLocalSystemTime.systemTime);</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY sDateTimeFull : STRING</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="sDayOfWeek" ObjectId="a30c2e4c-1ca2-4e89-9e2d-02cd951dbf57">
                    <interface>
                      <returnType>
                        <string />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wDateW	:=  GetLocalSystemTime.systemTime.wDayOfWeek;
IF wDateW = 0 THEN
	sDayOfWeek := 'Sunday';
ELSIF wDateW = 1 THEN
	sDayOfWeek := 'Monday';
ELSIF wDateW = 2 THEN
	sDayOfWeek := 'Tuesday';
ELSIF wDateW = 3 THEN
	sDayOfWeek := 'Wednesday';
ELSIF wDateW = 4 THEN
	sDayOfWeek := 'Thursday';
ELSIF wDateW = 5 THEN
	sDayOfWeek := 'Friday';
ELSIF wDateW = 6 THEN
	sDayOfWeek := 'Saturday';
END_IF</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY sDayOfWeek : STRING</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="sTime" ObjectId="dc607d9d-5fbb-4395-9f68-3f6b3c933e1d">
                    <interface>
                      <returnType>
                        <string />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">sTime := MID(sDateTimeFull,8,12);</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY sTime : STRING</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wDay" ObjectId="0509d925-5e29-455a-a44b-917daa4ddc34">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wDay :=  GetLocalSystemTime.systemTime.wDay;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wDay : Word</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wHour" ObjectId="14568886-a968-428a-89a9-3c243eca2652">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wHour	:=	GetLocalSystemTime.systemTime.wHour;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wHour : WORD</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wMilliSeconds" ObjectId="f711972c-4a15-43a3-ad14-70806eb762d2">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wMilliseconds	:=	GetLocalSystemTime.systemTime.wMilliseconds;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wMilliSeconds : WORD</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wMinute" ObjectId="ac2d1731-3055-4d58-aa2f-70efe444c3ed">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wMinute	:=	GetLocalSystemTime.systemTime.wMinute;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wMinute : WORD</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wMonth" ObjectId="b5c40313-975b-4dad-895d-5f967944c06e">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wMonth	:=  GetLocalSystemTime.systemTime.wMonth;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wMonth : Word</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wSecond" ObjectId="942dd1c0-a6e6-4375-8dd6-b31d1974723f">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wSecond	:=	GetLocalSystemTime.systemTime.wSecond;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wSecond : WORD</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/property" handleUnknown="implementation">
                  <Property name="wYear" ObjectId="1e665b64-e124-4d08-81b7-d54481c382a4">
                    <interface>
                      <returnType>
                        <WORD />
                      </returnType>
                    </interface>
                    <GetAccessor>
                      <interface />
                      <body>
                        <ST>
                          <xhtml xmlns="http://www.w3.org/1999/xhtml">wYear :=  GetLocalSystemTime.systemTime.wYear;</xhtml>
                        </ST>
                      </body>
                      <InterfaceAsPlainText>
                        <xhtml xmlns="http://www.w3.org/1999/xhtml">VAR
END_VAR
</xhtml>
                      </InterfaceAsPlainText>
                      <addData />
                    </GetAccessor>
                    <InterfaceAsPlainText>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">PROPERTY wYear : Word</xhtml>
                    </InterfaceAsPlainText>
                    <addData />
                  </Property>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">FUNCTION_BLOCK FB_SystemTime
VAR_INPUT
END_VAR
VAR_OUTPUT
END_VAR
VAR
	GetLocalSystemTime 	: FB_LocalSystemTime;
	wDateW				: WORD;
END_VAR
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>2c748e60-9fff-4e65-a896-a31986ab9309</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="MAIN" pouType="program">
              <interface>
                <localVars>
                  <variable name="nSample">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="fbSource">
                    <type>
                      <derived name="FB_CMA_Source" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="stInitPars">
                          <simpleValue value="cInitSource" />
                        </value>
                        <value member="nOwnID">
                          <simpleValue value="eID_Source" />
                        </value>
                        <value member="aDestIDs">
                          <arrayValue>
                            <value>
                              <simpleValue value="eID_MagSpectrum" />
                            </value>
                            <value>
                              <simpleValue value="eID_EnvSpectrum" />
                            </value>
                            <value>
                              <simpleValue value="eID_Env" />
                            </value>
                            <value>
                              <simpleValue value="eID_RMS" />
                            </value>
                          </arrayValue>
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbSinkMagSpec">
                    <type>
                      <derived name="FB_CMA_Sink" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nOwnID">
                          <simpleValue value="eID_MagSpec_Sink" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbSinkEnvSpec">
                    <type>
                      <derived name="FB_CMA_Sink" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nOwnID">
                          <simpleValue value="eID_EnvSpec_Sink" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbSinkEnv">
                    <type>
                      <derived name="FB_CMA_Sink" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nOwnID">
                          <simpleValue value="eID_Env_Sink" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbSinkRMS">
                    <type>
                      <derived name="FB_CMA_Sink" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="nOwnID">
                          <simpleValue value="eID_RMS_Sink" />
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="nChannelIdx">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="k">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="m">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="l">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="nChnIdx">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                </localVars>
              </interface>
              <actions>
                <action name="Sink">
                  <body>
                    <ST>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">// Push results to sink

fbSinkMagSpec.Output2DStd(	pDataOut 	:= ADR(aMagSpecResult), 
					nDataOutSize 		:= SIZEOF(aMagSpecResult), 
					eElementType 		:= eMA_TypeCode_LREAL, 
					nOptionPars			:= 0);
				
fbSinkEnvSpec.Output2DStd(	pDataOut 	:= ADR(aEnvSpecResult), 
					nDataOutSize 		:= SIZEOF(aEnvSpecResult), 
					eElementType 		:= eMA_TypeCode_LREAL, 
					nOptionPars			:= 0); 
					
fbSinkEnv.Output2DStd(	pDataOut 		:= ADR(aEnvResult), 
					nDataOutSize 		:= SIZEOF(aEnvResult), 
					eElementType 		:= eMA_TypeCode_LREAL, 
					nOptionPars			:= 0); 								
				
fbSinkRMS.Output2DStd(	pDataOut 		:= ADR(aRMSResult), 
					nDataOutSize 		:= SIZEOF(aRMSResult), 
					eElementType 		:= eMA_TypeCode_LREAL, 
					nOptionPars			:= 0); 						
			</xhtml>
                    </ST>
                  </body>
                  <addData>
                    <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                      <ObjectId>8275253b-e5d2-4fce-8863-ef6bc3f3c7a7</ObjectId>
                    </data>
                  </addData>
                </action>
                <action name="Source">
                  <body>
                    <ST>
                      <xhtml xmlns="http://www.w3.org/1999/xhtml">fbSource.Input2DStd( pDataIn 			:= ADR(aAccBuffer),
				  nDataInSize 			:= SIZEOF(aAccBuffer), 
				  eElementType 			:= eMA_TypeCode_LREAL,
				  nOptionPars			:= cCMA_Option_MarkInterruption ); 
</xhtml>
                    </ST>
                  </body>
                  <addData>
                    <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                      <ObjectId>61bbab0f-1f8f-4023-aa28-0a5332181413</ObjectId>
                    </data>
                  </addData>
                </action>
              </actions>
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml">Source();
Sink();
// input from EL3632
FOR nChannelIdx := 1 TO cMaxChannels DO
	FOR k := 1 TO cOversamples DO
		aAccBuffer[nChannelIdx][k] 		:= INT_TO_LREAL(aEl3632[nChannelIdx][k])*(5/EXPT(2,15))/(0.1)*9.81;
	END_FOR	
END_FOR

</xhtml>
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">PROGRAM MAIN
VAR
	nSample				: UDINT;
	
	fbSource			: FB_CMA_Source := (	stInitPars 	:= cInitSource, 
												nOwnID 		:= eID_Source, 
												aDestIDs 	:= [eID_MagSpectrum,
																eID_EnvSpectrum,
																eID_Env,
																eID_RMS]);		
										
	fbSinkMagSpec		: FB_CMA_Sink 	:= ( 	nOwnID 		:= eID_MagSpec_Sink);
	fbSinkEnvSpec		: FB_CMA_Sink 	:= ( 	nOwnID 		:= eID_EnvSpec_Sink);
	fbSinkEnv			: FB_CMA_Sink 	:= ( 	nOwnID 		:= eID_Env_Sink);
	fbSinkRMS			: FB_CMA_Sink 	:= ( 	nOwnID 		:= eID_RMS_Sink); 
	
	nChannelIdx			: UDINT;

	k, m, l: UDINT;
	nChnIdx: UDINT;
END_VAR
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>f43e4d9a-cbdc-4819-b719-b866da5ea61a</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="MAIN_CM" pouType="program">
              <interface>
                <localVars>
                  <variable name="fbMagSpec">
                    <type>
                      <derived name="FB_CMA_MagnitudeSpectrum" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="stInitPars">
                          <simpleValue value="cInitSpectrum" />
                        </value>
                        <value member="nOwnID">
                          <simpleValue value="eID_MagSpectrum" />
                        </value>
                        <value member="aDestIDs">
                          <arrayValue>
                            <value>
                              <simpleValue value="eID_MagSpec_Sink" />
                            </value>
                          </arrayValue>
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbEnvSpec">
                    <type>
                      <derived name="FB_CMA_EnvelopeSpectrum" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="stInitPars">
                          <simpleValue value="cInitEnvSpec" />
                        </value>
                        <value member="nOwnID">
                          <simpleValue value="eID_EnvSpectrum" />
                        </value>
                        <value member="aDestIDs">
                          <arrayValue>
                            <value>
                              <simpleValue value="eID_EnvSpec_Sink" />
                            </value>
                          </arrayValue>
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbEnv">
                    <type>
                      <derived name="FB_CMA_Envelope" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="stInitPars">
                          <simpleValue value="cInitEnv" />
                        </value>
                        <value member="nOwnID">
                          <simpleValue value="eID_Env" />
                        </value>
                        <value member="aDestIDs">
                          <arrayValue>
                            <value>
                              <simpleValue value="eID_Env_Sink" />
                            </value>
                          </arrayValue>
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="fbRMS">
                    <type>
                      <derived name="FB_CMA_IntegratedRMS" />
                    </type>
                    <initialValue>
                      <structValue>
                        <value member="stInitPars">
                          <simpleValue value="cInitIRMS" />
                        </value>
                        <value member="nOwnID">
                          <simpleValue value="eID_RMS" />
                        </value>
                        <value member="aDestIDs">
                          <arrayValue>
                            <value>
                              <simpleValue value="eID_RMS_Sink" />
                            </value>
                          </arrayValue>
                        </value>
                      </structValue>
                    </initialValue>
                  </variable>
                  <variable name="nErrorID">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="fbErrHist">
                    <type>
                      <derived name="FB_HRErrHist" />
                    </type>
                  </variable>
                  <variable name="hrErrList">
                    <type>
                      <array>
                        <dimension lower="1" upper="2" />
                        <baseType>
                          <derived name="HRESULT" />
                        </baseType>
                      </array>
                    </type>
                  </variable>
                  <variable name="bPause">
                    <type>
                      <BOOL />
                    </type>
                  </variable>
                </localVars>
              </interface>
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml">IF NOT bPause THEN
//
END_IF

PRG_Database();
PRG_Motor_Sensor();

fbMagSpec.Call();
fbEnvSpec.Call();
fbEnv.Call();

fbRMS.Call();
//fbHistArray.CallEx(nAppendData := cAppendData, bResetData := bResetHist);
</xhtml>
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">PROGRAM MAIN_CM
VAR
	fbMagSpec			: FB_CMA_MagnitudeSpectrum 
						:= (	stInitPars 	:= cInitSpectrum, 
								nOwnID 		:= eID_MagSpectrum, 
								aDestIDs 	:= [eID_MagSpec_Sink] ); 
										
	fbEnvSpec			: FB_CMA_EnvelopeSpectrum 
						:= ( 	stInitPars 	:= cInitEnvSpec, 
								nOwnID 		:= eID_EnvSpectrum, 
								aDestIDs 	:= [eID_EnvSpec_Sink] );	
								
	fbEnv				: FB_CMA_Envelope 
						:= ( 	stInitPars 	:= cInitEnv, 
								nOwnID 		:= eID_Env, 
								aDestIDs 	:= [eID_Env_Sink] );	
								
	fbRMS				: FB_CMA_IntegratedRMS
						:= ( 	stInitPars	:= cInitIRMS,
								nOwnID		:= eID_RMS,
								aDestIDs	:= [eID_RMS_Sink]);
		
	nErrorID			: UDINT;
	fbErrHist			: FB_HRErrHist; 
	hrErrList			: ARRAY[1..2] OF HRESULT;
	bPause				: BOOL;
	
END_VAR
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>a4bbe322-8edd-4c70-a772-9f2cb18a3983</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="PRG_Calculate" pouType="program">
              <interface>
                <localVars>
                  <variable name="nChnIdx">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="i">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="k">
                    <type>
                      <UDINT />
                    </type>
                  </variable>
                  <variable name="m">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                  </variable>
                  <variable name="n">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                  </variable>
                  <variable name="p">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                  </variable>
                  <variable name="j">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                  </variable>
                  <variable name="l">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                  </variable>
                  <variable name="q">
                    <type>
                      <UDINT />
                    </type>
                    <initialValue>
                      <simpleValue value="1" />
                    </initialValue>
                  </variable>
                  <variable name="fSumRMSEnv">
                    <type>
                      <LREAL />
                    </type>
                  </variable>
                </localVars>
              </interface>
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml">FOR nChnIdx := 1 TO cMaxChannels DO
	// Calculate Frequency
	fSampleRate								:= cOversamples * (1000.0 / fSampleTaskCycleTime);
	fResolution 							:= fSampleRate / cFFTLength;	
	
	// Calculate velocity spectrum                              	     	
	FOR i := 1 TO cFFTResult DO             	
		fFrequency[nChnIdx][i]				:= (i - 1) * fResolution;			
		IF i &lt;&gt; 1 THEN
			aVeloSpecResult[nChnIdx][i]		:= aMagSpecResult[nChnIdx][i]/(2*PI*fFrequency[nChnIdx][i])*1000;
		ELSE
			aVeloSpecResult[nChnIdx][i]		:= 0;
		END_IF
	END_FOR
	
	//Calculate RMS of Envelope
	fSumRMSEnv 								:= 0;
	FOR p := 1 TO cBufferLength DO
		fSumRMSEnv							:= fSumRMSEnv + EXPT(aEnvResult[nChnIdx][p],2);
	END_FOR
	aRmsEnvResult[nChnIdx]					:= SQRT(fSumRMSEnv/cBufferLength);
	
	//Scale up for HMI 
	IF m &lt; cScaleHMI THEN
		FOR n := 1 TO cOversamples DO
			aTWFBuffer[nChnIdx][(m-1)*10+n]		:= aAccBuffer[nChnIdx][n];   
		END_FOR
		m										:= m + 1;
	ELSE
		m										:= cScaleHMI;
		FOR l := 1 TO cScaleHMI-1 DO
			FOR n := 1 TO cOversamples DO
				aTWFBuffer[nChnIdx][(l-1)*10+n]	:= aTWFBuffer[nChnIdx][(l)*10+n];   
			END_FOR
		END_FOR
		FOR q := 1 TO cOversamples DO
			aTWFBuffer[nChnIdx][(m-1)*10+q]		:= aAccBuffer[nChnIdx][q];   
		END_FOR	
	END_IF	
	
END_FOR

IF aTime[cOversamples*cScaleHMI] &lt;&gt; cOversamples*cScaleHMI THEN
	FOR k := 1 TO cOversamples*cScaleHMI DO aTime[k] := k; END_FOR
END_IF





</xhtml>
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">PROGRAM PRG_Calculate
VAR
	nChnIdx, i, k		: UDINT;
	m, n, p, j, l, q	: UDINT:= 1;
	fSumRMSEnv			: LREAL;
END_VAR
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>b71a404f-3110-4a01-8817-53e6d102e16a</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="PRG_Database" pouType="program">
              <interface>
                <localVars>
                  <variable name="fbSystemTime">
                    <type>
                      <derived name="FB_SystemTime" />
                    </type>
                  </variable>
                  <variable name="bSaveData">
                    <type>
                      <BOOL />
                    </type>
                  </variable>
                  <variable name="bLoadData">
                    <type>
                      <BOOL />
                    </type>
                  </variable>
                  <variable name="nStateSave">
                    <type>
                      <INT />
                    </type>
                  </variable>
                  <variable name="nStateLoad">
                    <type>
                      <INT />
                    </type>
                  </variable>
                  <variable name="tTimer1">
                    <type>
                      <derived name="TON" />
                    </type>
                  </variable>
                  <variable name="tTimer2">
                    <type>
                      <derived name="TON" />
                    </type>
                  </variable>
                  <variable name="bTest">
                    <type>
                      <BOOL />
                    </type>
                  </variable>
                  <variable name="nStateADS">
                    <type>
                      <INT />
                    </type>
                  </variable>
                </localVars>
              </interface>
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml">fbSystemTime();
sCurrentTime	:= fbSystemTime.sTime;
nCurrentSec		:= fbSystemTime.wSecond;
CASE nStateSave OF
	0:
		tTimer1(IN := FALSE);
		IF nCurrentSec = 70 OR sCurrentTime = '06:00:00' OR sCurrentTime = '14:00:00' OR sCurrentTime = '22:00:00' THEN
			nStateSave			:= 1;
		END_IF
	1:
		aFFTAcceleration1Add		:= aMagSpecResult[1];
		aFFTVelocity1Add			:= aVeloSpecResult[1];
		aFFTEnvelope1Add			:= aEnvSpecResult[1];
		RMSAcc1Add					:= aRMSResult[1][1]/9.81;
		RMSVel1Add					:= aRMSResult[1][2]*1000;
		RMSEnv1Add					:= aRMSEnvResult[1]/9.81;
		
		aFFTAcceleration2Add		:= aMagSpecResult[2];
		aFFTVelocity2Add			:= aVeloSpecResult[2];
		aFFTEnvelope2Add			:= aEnvSpecResult[2];
		RMSAcc2Add					:= aRMSResult[2][1]/9.81;
		RMSVel2Add					:= aRMSResult[2][2]*1000;
		RMSEnv2Add					:= aRMSEnvResult[2]/9.81;		
		bAddData					:= TRUE;
		nStateSave					:= 2;
	2:
		IF NOT bAddData THEN
			tTimer1(IN := TRUE,PT := T#2S);
			IF tTimer1.Q THEN
				nStateSave			:= 0;		
			END_IF	
		END_IF
			
		
END_CASE

CASE nStateADS OF
	0:
		IF bCheckADS THEN
			nStateADS := 1;
		ELSE
			tTimer2(IN := TRUE,PT := T#5S);
			IF tTimer2.Q THEN
				nStateADS := 2;
			END_IF
		END_IF
		
	1:
		bCheckADS := FALSE;
		bError	:= FALSE;
		tTimer2(IN := FALSE);
		nStateADS := 0;
	2:
		bError := TRUE;
		tTimer2(IN := FALSE);
		IF bCheckADS THEN
			nStateADS := 0;
		END_IF
END_CASE</xhtml>
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">PROGRAM PRG_Database
VAR
	fbSystemTime			:	FB_SystemTime;
	bSaveData				: BOOL;
	bLoadData				: BOOL;
	nStateSave, nStateLoad	: INT;
	tTimer1, tTimer2		: TON;
	bTest					: BOOL;
	nStateADS				: INT;
END_VAR
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>b3dcad82-b823-4b74-9063-472eff0074e5</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/pou" handleUnknown="implementation">
            <pou name="PRG_Motor_Sensor" pouType="program">
              <interface />
              <body>
                <ST>
                  <xhtml xmlns="http://www.w3.org/1999/xhtml">IF bMotorRun THEN
//	wMotorRun	:= 18;
ELSE
//	wMotorRun	:= 1;
END_IF

IF fFreq &gt;= 0 AND fFreq &lt;= 60 THEN
	wFreq		:= REAL_TO_WORD(fFreq*100);
END_IF</xhtml>
                </ST>
              </body>
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/interfaceasplaintext" handleUnknown="implementation">
                  <InterfaceAsPlainText>
                    <xhtml xmlns="http://www.w3.org/1999/xhtml">PROGRAM PRG_Motor_Sensor
VAR
END_VAR
</xhtml>
                  </InterfaceAsPlainText>
                </data>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>fb82d031-f928-4fe6-805c-8e0d308a101b</ObjectId>
                </data>
              </addData>
            </pou>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/libraries" handleUnknown="implementation">
            <Libraries>
              <Library Name="#Tc2_Standard" Namespace="Tc2_Standard" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc2_Standard, * (Beckhoff Automation GmbH)" />
              <Library Name="#Tc2_System" Namespace="Tc2_System" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc2_System, * (Beckhoff Automation GmbH)">
                <Parameters>
                  <Parameter Name="PARAM.TABLE_UPPER_BOUND" Value="15" />
                  <Parameter Name="PARAM.STRING_LENGTH_EXP" Value="255" />
                  <Parameter Name="PARAM.STRING_LENGTH_ADDRESS" Value="20" />
                  <Parameter Name="PARAM.STRING_LENGTH_COMMENT" Value="255" />
                  <Parameter Name="PARAM.STRING_LENGTH_OUTSTRING" Value="255" />
                  <Parameter Name="PARAM.TABLE_SHOW_VALID_ITEMS" Value="FALSE" />
                </Parameters>
              </Library>
              <Library Name="#Tc2_Utilities" Namespace="Tc2_Utilities" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc2_Utilities, * (Beckhoff Automation GmbH)">
                <Parameters>
                  <Parameter Name="PARAMETERLIST.NMAXLICENSES" Value="50" />
                  <Parameter Name="PARAMETERLIST.NMAXLICENSEDEVICES" Value="16" />
                  <Parameter Name="PARAMETERLIST.NMAXCPUCOUNT" Value="64" />
                  <Parameter Name="PARAMETERLIST.CMAXCHARACTERS" Value="16#FFFFFFF0" />
                  <Parameter Name="PARAMETERLIST.NMAXFILESONDONGLE" Value="20" />
                  <Parameter Name="PARAMETERLIST.CMAXCSVFIELDVALUESIZE" Value="255" />
                </Parameters>
              </Library>
              <Library Name="#Tc3_CM" Namespace="Tc3_CM" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc3_CM, * (Beckhoff Automation GmbH)">
                <Parameters>
                  <Parameter Name="PARAM_CM.CCMA_READCSVBUFFERSIZE" Value="20000" />
                </Parameters>
              </Library>
              <Library Name="#Tc3_CM_Base" Namespace="Tc3_CM_Base" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc3_CM_Base, * (Beckhoff Automation GmbH)">
                <Parameters>
                  <Parameter Name="PARAM.EEVENTTRACELEVEL" Value="TcEventSeverity.Critical" />
                </Parameters>
              </Library>
              <Library Name="#Tc3_Filter" Namespace="Tc3_Filter" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc3_Filter, * (Beckhoff Automation GmbH)" />
              <Library Name="#Tc3_Module" Namespace="Tc3_Module" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc3_Module, * (Beckhoff Automation GmbH)" />
              <Library Name="#Tc3_MultiArray" Namespace="Tc3_MultiArray" HideWhenReferencedAsDependency="false" PublishSymbolsInContainer="false" SystemLibrary="false" LinkAllContent="false" DefaultResolution="Tc3_MultiArray, * (Beckhoff Automation GmbH)" />
              <addData>
                <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
                  <ObjectId>aa809193-a2fc-4a94-b8bb-00b8b8996475</ObjectId>
                </data>
              </addData>
            </Libraries>
          </data>
          <data name="http://www.3s-software.com/plcopenxml/objectid" handleUnknown="discard">
            <ObjectId>92a42d4b-d19b-4ec8-8d61-5791dd67b668</ObjectId>
          </data>
        </addData>
      </resource>
    </data>
    <data name="http://www.3s-software.com/plcopenxml/projectstructure" handleUnknown="discard">
      <ProjectStructure>
        <Object Name="CM" ObjectId="92a42d4b-d19b-4ec8-8d61-5791dd67b668">
          <Object Name="Library Manager" ObjectId="aa809193-a2fc-4a94-b8bb-00b8b8996475" />
          <Folder Name="DUTs">
            <Object Name="E_AnalysisIDs" ObjectId="986ef521-a979-48e2-815b-4873c48699c5" />
            <Object Name="ST_HRErrHist" ObjectId="92d421d1-d14f-450b-983f-70e2be9df404" />
          </Folder>
          <Folder Name="FBs">
            <Object Name="FB_HRErrHist" ObjectId="13dd99e4-0dfe-493f-a13d-ce2e0387ba70">
              <Object Name="AddError" ObjectId="3dd500b8-1225-4214-9779-654309748312" />
              <Object Name="Reset" ObjectId="ce39411f-0156-4af2-b1ba-49d3b754a640" />
            </Object>
            <Object Name="FB_SystemTime" ObjectId="2c748e60-9fff-4e65-a896-a31986ab9309">
              <Object Name="dtDateTimeFull" ObjectId="5d9db981-e399-476f-9f44-b7969859fd33" />
              <Object Name="sDate" ObjectId="adb2b91a-c3a4-4948-a9ab-17c03886c6a1" />
              <Object Name="sDateTime" ObjectId="ddd67e66-e1a4-4207-aac8-28653586b9f3" />
              <Object Name="sDateTimeFull" ObjectId="ec972ccc-929a-446b-93da-990283db8464" />
              <Object Name="sDayOfWeek" ObjectId="a30c2e4c-1ca2-4e89-9e2d-02cd951dbf57" />
              <Object Name="sTime" ObjectId="dc607d9d-5fbb-4395-9f68-3f6b3c933e1d" />
              <Object Name="wDay" ObjectId="0509d925-5e29-455a-a44b-917daa4ddc34" />
              <Object Name="wHour" ObjectId="14568886-a968-428a-89a9-3c243eca2652" />
              <Object Name="wMilliSeconds" ObjectId="f711972c-4a15-43a3-ad14-70806eb762d2" />
              <Object Name="wMinute" ObjectId="ac2d1731-3055-4d58-aa2f-70efe444c3ed" />
              <Object Name="wMonth" ObjectId="b5c40313-975b-4dad-895d-5f967944c06e" />
              <Object Name="wSecond" ObjectId="942dd1c0-a6e6-4375-8dd6-b31d1974723f" />
              <Object Name="wYear" ObjectId="1e665b64-e124-4d08-81b7-d54481c382a4" />
            </Object>
          </Folder>
          <Folder Name="GVLs">
            <Object Name="CM_Params" ObjectId="b7ffc7d5-c01a-4239-986a-7d3c590e2c97" />
            <Object Name="CM_Data" ObjectId="af15e22b-5a15-4213-aaa6-6abac18438b4" />
            <Object Name="GVL_ADS" ObjectId="dd8c9214-c0f8-4f89-aa33-d6e95d86f9cb" />
            <Object Name="GVL_IO" ObjectId="9a7e8e54-9d5a-417d-b728-f2e366fe1d2a" />
          </Folder>
          <Object Name="PlcTask" ObjectId="cdcdb954-4ebb-4ef3-bb5b-af9257ff7c35" />
          <Object Name="PlcTaskCM" ObjectId="e1e11ed9-f333-4b54-9253-b27635168571" />
          <Folder Name="MAIN">
            <Object Name="MAIN" ObjectId="f43e4d9a-cbdc-4819-b719-b866da5ea61a">
              <Object Name="Sink" ObjectId="8275253b-e5d2-4fce-8863-ef6bc3f3c7a7" />
              <Object Name="Source" ObjectId="61bbab0f-1f8f-4023-aa28-0a5332181413" />
            </Object>
            <Object Name="MAIN_CM" ObjectId="a4bbe322-8edd-4c70-a772-9f2cb18a3983" />
          </Folder>
          <Folder Name="PRGs">
            <Object Name="PRG_Calculate" ObjectId="b71a404f-3110-4a01-8817-53e6d102e16a" />
            <Object Name="PRG_Database" ObjectId="b3dcad82-b823-4b74-9063-472eff0074e5" />
            <Object Name="PRG_Motor_Sensor" ObjectId="fb82d031-f928-4fe6-805c-8e0d308a101b" />
          </Folder>
          <Object Name="TaskCalc" ObjectId="628d2a1e-b407-4f45-b435-117ba41b8a1f" />
        </Object>
      </ProjectStructure>
    </data>
  </addData>
</project>